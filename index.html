<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Personal website showcasing projects, writings, and inspirations.">
    <title>con.rad | v3.0</title>

    <!-- Site Configuration Loader - loads from /data/config.json -->
    <script src="./assets/js/config-loader.js"></script>

    <!-- Fallback config for when fetch fails (e.g., file:// protocol) -->
    <script>
      const needsFallback = !window.SITE_CONFIG ||
                            Object.keys(window.SITE_CONFIG).length === 0 ||
                            (window.SITE_CONFIG.collection &&
                             window.SITE_CONFIG.collection.length > 0 &&
                             !window.SITE_CONFIG.collection[0].type);
      if (needsFallback) {
        console.log('[Config Fallback] Using embedded fallback config');
        window.SITE_CONFIG = {
          "backgroundArt": {
            "src": "https://cdn.feralfileassets.com/previews/500ccc6e-d7ad-443f-a9df-0bf709b3b3c9/1645052262/index.html",
            "title": "36 Points",
            "artist": "Sage Jenson",
            "year": "2022"
          },
          "artworks": [
            {"title": "36 Points", "artist": "Sage Jenson", "year": "2022", "url": "https://cdn.feralfileassets.com/previews/500ccc6e-d7ad-443f-a9df-0bf709b3b3c9/1645052262/index.html"},
            {"title": "monogrid 1.1 CE #34", "artist": "Kim Asendorf", "year": "2022", "url": "https://ipfs.io/ipfs/QmQtaLb8fC7DUebFLTbkj3p7ByVVDxtRu7Na56dyo5BgM9/?fxhash=onteKmUycJyeWGjdavoVrqn74XQHsjVFfmMSBtocPigg7a7TryE"},
            {"title": "Spiders", "artist": "Piter Pasma", "year": "2021", "url": "https://ipfs.io/ipfs/QmSbrCo52wPrcLUQwGdtbcLFQjjrhnR4M8wdcXtpbYtNFb/"},
            {"title": "Reading a book #873", "artist": "Kim Asendorf", "year": "2021", "url": "https://ipfs.io/ipfs/QmUtfp5tvPwVefWQrhjTMEt9Xy3J4VooMjbR29qSPCvz6F/"},
            {"title": "C-SCAPE #36", "artist": "Toxi", "year": "2022", "url": "https://ipfs.io/ipfs/QmdHhcTBEUUNZ68gWHUsSRfjFrHYXStvgMvB6HwS1bVbMG/?fxhash=oo9ANVZwtvSGktuEZiVxN9oDWyfL7W9L71c5e6WZnMHNWTSfSka"}
          ],
          "collection": [
            {"thumbnail": "https://ipfs.io/ipfs/QmQV57honsnKiWnsgRikU43WL5h4tk2eSi9QcsaphBiSsJ", "render": "https://ipfs.io/ipfs/QmQV57honsnKiWnsgRikU43WL5h4tk2eSi9QcsaphBiSsJ", "title": "CSRSNT-ZAAI-45-of-64.png", "artist": "Caesuras (Casey Reas)", "medium": "Digital Art", "type": "image", "description": ""},
            {"thumbnail": "https://ipfs.io/ipfs/QmTdTi3ctvT1Npcp6eKDuN1notyZoVJuTYK6iRivcKpW8V", "render": "https://ipfs.io/ipfs/QmTdTi3ctvT1Npcp6eKDuN1notyZoVJuTYK6iRivcKpW8V", "title": "The Starry Night: Not Van Gogh, Not Sorry", "artist": "Helena Sarin", "medium": "Digital Art", "type": "image", "description": ""},
            {"thumbnail": "https://ipfs.io/ipfs/QmSRtLFUF39tsj639EsAk1uZKRCDvYMGHcCQwsqdqpiXMs", "render": "https://ipfs.io/ipfs/QmSRtLFUF39tsj639EsAk1uZKRCDvYMGHcCQwsqdqpiXMs", "title": "Lushtemples", "artist": "Zancan", "medium": "Digital Art", "type": "image", "description": ""}
          ],
          "writings": [
            {"id": "on-collecting", "title": "On Collecting", "description": "There's something deeply human about the act of collecting. We gather objects, images, sounds, and ideas not just to possess them, but to create a mirror of ourselves.", "date": "2026-01-15", "body": []},
            {"id": "digital-gardens", "title": "Digital Gardens", "description": "A website doesn't have to be a publication. It can be a garden—a place where ideas grow, evolve, and sometimes wither.", "date": "2026-01-10", "body": []},
            {"id": "the-space-between", "title": "The Space Between", "description": "The most interesting things happen at the edges—where art meets technology, where structure meets chaos.", "date": "2025-12-20", "body": []}
          ],
          "inspirations": {
            "channel": "visually-intriguing",
            "channelUrl": "https://www.are.na/conrad-house/visually-intriguing",
            "itemCount": 12
          },
          "profile": {
            "name": "Conrad House",
            "title": "",
            "bio": ["chronically online.", "techno-curious.", "art and music junky."],
            "photo": "./assets/images/misc/profilepicture.png"
          },
          "social": {
            "email": "hello@conrad.house",
            "github": "",
            "twitter": ""
          }
        };
        try { localStorage.setItem('conradSiteConfig', JSON.stringify(window.SITE_CONFIG)); } catch(e) {}
      }
    </script>

    <script src="https://cdn.tailwindcss.com/3.4.17"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&family=Space+Grotesk:wght@300..700&family=Syne:wght@400;700;800&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'mono': ['"JetBrains Mono"', 'monospace'],
                        'sans': ['"Space Grotesk"', 'sans-serif'],
                        'display': ['"Syne"', 'sans-serif'],
                    },
                    colors: {
                        'acid': '#ccff00',
                        'neon-blue': '#00f3ff',
                        'void': '#050505',
                        'glass': 'rgba(255, 255, 255, 0.05)',
                        'glass-dark': 'rgba(0, 0, 0, 0.6)',
                        'border-dim': 'rgba(255, 255, 255, 0.1)',
                    },
                    animation: {
                        'spin-slow': 'spin 12s linear infinite',
                        'blink': 'blink 1s step-end infinite',
                        'marquee': 'marquee 25s linear infinite',
                        'glitch': 'glitch 1s linear infinite',
                    },
                    keyframes: {
                        blink: {
                            '0%, 100%': { opacity: '1' },
                            '50%': { opacity: '0' },
                        },
                        marquee: {
                            '0%': { transform: 'translateX(0%)' },
                            '100%': { transform: 'translateX(-100%)' },
                        },
                        glitch: {
                            '2%, 64%': { transform: 'translate(2px,0) skew(0deg)' },
                            '4%, 60%': { transform: 'translate(-2px,0) skew(0deg)' },
                            '62%': { transform: 'translate(0,0) skew(5deg)' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #050505;
        }
        ::-webkit-scrollbar-thumb {
            background: #333;
            border-radius: 3px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #ccff00;
        }

        .scanlines {
            background: linear-gradient(
                to bottom,
                rgba(255,255,255,0),
                rgba(255,255,255,0) 50%,
                rgba(0,0,0,0.1) 50%,
                rgba(0,0,0,0.1)
            );
            background-size: 100% 4px;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            pointer-events: none;
            z-index: 9999;
            opacity: 0.6;
        }

        .noise {
            position: fixed;
            top: 0; left: 0; width: 100vw; height: 100vh;
            pointer-events: none;
            z-index: 9998;
            opacity: 0.03;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
        }

        ::selection {
            background: #ccff00;
            color: #000;
        }

        .glass-panel {
            background: rgba(10, 10, 10, 0.6);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }

        .text-outline {
            -webkit-text-stroke: 1px rgba(255,255,255,0.2);
            color: transparent;
        }

        .hover-glitch:hover {
            animation: glitch 0.3s cubic-bezier(.25, .46, .45, .94) both infinite;
            color: #ccff00;
        }

        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Marquee for track titles */
        @keyframes scroll-title {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }
        .scrolling {
            animation: scroll-title 12s linear infinite;
            display: inline-block;
        }
    </style>

</head>
<body class="bg-void text-gray-200 antialiased overflow-x-hidden selection:bg-acid selection:text-black">

    <!-- Background Art -->
    <div class="fixed inset-0 z-0">
        <iframe
            id="art-frame"
            src=""
            class="w-full h-full border-none opacity-60 grayscale-[20%] transition-opacity duration-700 ease-in-out"
            allow="autoplay">
        </iframe>
        <div class="absolute inset-0 bg-void/30 pointer-events-none"></div>
    </div>

    <!-- Overlays -->
    <div class="scanlines"></div>
    <div class="noise"></div>

    <!-- Mobile Splash Screen -->
    <div id="mobile-splash" class="fixed inset-0 z-[200] bg-void flex flex-col items-center justify-center p-8 md:hidden">
        <div class="text-center max-w-sm">
            <div class="font-mono text-acid text-xs tracking-widest mb-6 animate-pulse">DEVICE_CHECK_FAILED</div>
            <pre class="text-acid text-4xl mb-6 leading-none">
  ___
 /   \
| x_x |
 \___/
            </pre>
            <h2 class="font-display text-2xl font-bold text-white mb-4">Desktop Required</h2>
            <p class="font-sans text-gray-400 text-sm leading-relaxed mb-6">
                This experience was built for larger screens. The generative art, layouts, and interactions need room to breathe.
            </p>
            <p class="font-mono text-[10px] text-gray-600 uppercase tracking-widest">
                sorry phone users...come back on desktop
            </p>
            <div class="mt-8 flex justify-center gap-2">
                <span class="w-2 h-2 bg-acid/30 animate-pulse"></span>
                <span class="w-2 h-2 bg-acid/50 animate-pulse" style="animation-delay: 0.2s"></span>
                <span class="w-2 h-2 bg-acid animate-pulse" style="animation-delay: 0.4s"></span>
            </div>
        </div>
    </div>

    <!-- Intro Loader -->
    <div id="intro" class="fixed inset-0 z-[100] bg-void flex flex-col items-center justify-center transition-opacity duration-1000 pointer-events-none">
        <div class="text-acid font-mono text-xs mb-2 animate-pulse">SYSTEM_BOOT_SEQUENCE</div>
        <div class="text-6xl font-display font-bold tracking-tighter mix-blend-difference text-white mb-4">CON.RAD</div>
        <div class="w-64 h-1 bg-gray-900 rounded overflow-hidden">
            <div id="loader" class="h-full bg-acid w-0 transition-all duration-[1500ms] ease-out"></div>
        </div>
    </div>

    <!-- Header -->
    <header class="fixed top-0 left-0 right-0 z-50 px-6 py-4 flex justify-between items-start pointer-events-none mix-blend-difference text-white">
        <div class="pointer-events-auto group cursor-pointer">
            <h1 class="font-display font-bold text-2xl tracking-tighter leading-none group-hover:text-acid transition-colors">con.rad</h1>
            <p class="font-mono text-[10px] opacity-70 tracking-widest mt-1">BUILDING CURIOSITY...</p>
        </div>

        <nav class="pointer-events-auto hidden md:flex items-center gap-8 font-mono text-xs tracking-wider">
            <a href="./writings/index.html" class="hover:text-acid hover:underline underline-offset-4 decoration-acid decoration-1">[ WRITINGS ]</a>
            <a href="./collection/index.html" class="hover:text-acid hover:underline underline-offset-4 decoration-acid decoration-1">[ COLLECTION ]</a>
            <a href="./projects/index.html" class="hover:text-acid hover:underline underline-offset-4 decoration-acid decoration-1">[ PROJECTS ]</a>
            <a href="https://www.are.na/conrad-house/visually-intriguing" target="_blank" class="hover:text-acid hover:underline underline-offset-4 decoration-acid decoration-1">[ ARE.NA ]</a>
            <span class="w-2 h-2 rounded-full bg-acid animate-pulse shadow-[0_0_10px_#ccff00]"></span>
        </nav>

        <button id="mobile-menu-btn" class="md:hidden pointer-events-auto text-acid">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="square" stroke-linejoin="miter" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
        </button>
    </header>

    <!-- Main Content -->
    <main class="relative z-10 pt-32 pb-48 px-4 md:px-0 max-w-7xl mx-auto flex flex-col md:flex-row gap-8">

        <!-- Sidebar -->
        <aside class="md:w-1/4 md:sticky md:top-32 h-fit space-y-6">
            <div class="glass-panel p-6 rounded-sm">
                <div class="relative w-full aspect-square mb-4 overflow-hidden border border-border-dim group">
                    <img id="profile-photo" src="./assets/images/misc/profilepicture.png" alt="Profile" class="w-full h-full object-cover grayscale contrast-125 group-hover:grayscale-0 transition-all duration-500">
                    <div class="absolute inset-0 bg-acid/10 mix-blend-overlay opacity-0 group-hover:opacity-100 transition-opacity"></div>
                    <div class="absolute top-2 right-2 text-[10px] font-mono bg-black text-white px-1">IMG_001</div>
                </div>

                <h2 id="profile-name" class="font-display font-bold text-xl mb-1">Conrad House</h2>
                <p class="font-mono text-xs text-gray-500 mb-3">aka nemocake</p>
                <div id="profile-bio" class="font-mono text-xs text-gray-400 mb-4 leading-relaxed">
                    <span class="text-acid">></span> chronically online.<br>
                    <span class="text-acid">></span> techno-curious.<br>
                    <span class="text-acid">></span> art and music junky.
                </div>

                <div class="border-t border-dashed border-gray-700 my-4"></div>

                <div class="font-mono text-[10px] uppercase tracking-wider text-gray-500 space-y-2">
                    <div class="flex justify-between">
                        <span>Status</span>
                        <span class="text-green-400">● Online</span>
                    </div>
                    <div class="flex justify-between">
                        <span>Location</span>
                        <span>LATENTSPACE</span>
                    </div>
                    <div class="flex justify-between">
                        <span>Local Time</span>
                        <span id="clock">00:00:00 PST</span>
                    </div>
                </div>
            </div>

            <!-- Mobile Nav -->
            <div class="glass-panel p-4 md:hidden">
                <div class="grid grid-cols-2 gap-2 text-center font-mono text-xs">
                    <a href="./writings/index.html" class="p-2 border border-border-dim hover:bg-white/10">Writings</a>
                    <a href="./collection/index.html" class="p-2 border border-border-dim hover:bg-white/10">Collection</a>
                    <a href="./projects/index.html" class="p-2 border border-border-dim hover:bg-white/10">Projects</a>
                    <a href="https://www.are.na/conrad-house/visually-intriguing" target="_blank" class="p-2 border border-border-dim hover:bg-white/10">Are.na</a>
                </div>
            </div>
        </aside>

        <!-- Content Area -->
        <div class="md:w-3/4 space-y-24">

            <!-- Writings Section -->
            <section id="writings" class="relative group">
                <div class="flex items-center gap-4 mb-8">
                    <span class="font-mono text-acid text-sm">01.</span>
                    <h2 class="font-display text-4xl font-bold uppercase">Writings</h2>
                    <div class="h-[1px] flex-grow bg-gradient-to-r from-acid to-transparent opacity-50"></div>
                </div>

                <div id="writings-grid" class="grid md:grid-cols-2 gap-4">
                    <!-- Populated by JS -->
                </div>
            </section>

            <!-- Collection Section -->
            <section id="collection">
                <div class="flex items-center gap-4 mb-8">
                    <span class="font-mono text-acid text-sm">02.</span>
                    <h2 class="font-display text-4xl font-bold uppercase">Collection</h2>
                    <div class="h-[1px] flex-grow bg-gradient-to-r from-acid to-transparent opacity-50"></div>
                    <a href="./collection/index.html" class="font-mono text-xs border border-gray-700 px-3 py-1.5 hover:border-acid hover:text-acid transition-colors">GALLERY →</a>
                </div>

                <div class="glass-panel p-4">
                    <div id="collection-grid" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <!-- Populated by JS -->
                    </div>
                </div>
            </section>

            <!-- Projects Section -->
            <section id="projects">
                <div class="flex items-center gap-4 mb-8">
                    <span class="font-mono text-acid text-sm">03.</span>
                    <h2 class="font-display text-4xl font-bold uppercase">Building</h2>
                    <div class="h-[1px] flex-grow bg-gradient-to-r from-acid to-transparent opacity-50"></div>
                </div>

                <div id="github-repos" class="space-y-4">
                    <!-- Populated by JS -->
                </div>
            </section>

             <!-- Inspirations Section -->
             <section id="inspirations">
                <div class="flex items-center gap-4 mb-8">
                    <span class="font-mono text-acid text-sm">04.</span>
                    <h2 class="font-display text-4xl font-bold uppercase">Visually Intriguing</h2>
                    <div class="h-[1px] flex-grow bg-gradient-to-r from-acid to-transparent opacity-50"></div>
                    <div class="flex items-center gap-2">
                        <button id="arena-prev" class="font-mono text-xs border border-gray-700 px-2 py-1 hover:border-acid hover:text-acid transition-colors disabled:opacity-30 disabled:cursor-not-allowed">←</button>
                        <button id="arena-next" class="font-mono text-xs border border-gray-700 px-2 py-1 hover:border-acid hover:text-acid transition-colors disabled:opacity-30 disabled:cursor-not-allowed">→</button>
                    </div>
                    <a href="https://www.are.na/conrad-house/visually-intriguing" target="_blank" class="font-mono text-xs border border-gray-700 px-3 py-1.5 hover:border-acid hover:text-acid transition-colors">ARE.NA →</a>
                </div>

                <div class="glass-panel p-4">
                    <div id="arena-grid" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <!-- Populated by JS -->
                    </div>
                </div>
             </section>

        </div>
    </main>

    <!-- Footer -->
    <footer class="relative z-10 border-t border-white/10 bg-black/80 backdrop-blur-md mt-12 py-12">
        <div class="max-w-7xl mx-auto px-6 flex flex-col md:flex-row justify-between items-end gap-6">
            <div>
                <h3 class="font-display text-2xl mb-2">con.rad</h3>
                <p class="font-mono text-xs text-gray-500">© <span id="current-year"></span> conrad house. curiously tinkering and breaking things.</p>
            </div>
            <div class="flex gap-6 font-mono text-xs">
                <a href="#" onclick="openContactModal(); return false;" class="hover:text-acid hover:underline">CONTACT</a>
                <a href="https://github.com/nemocake" target="_blank" class="hover:text-acid hover:underline">GITHUB</a>
                <a href="https://x.com/DlSPUTED" target="_blank" class="hover:text-acid hover:underline">TWITTER/X</a>
            </div>
        </div>
    </footer>

    <!-- Winamp-style Music Player -->
    <div id="y2k-player" class="fixed bottom-6 left-6 z-50 w-72 glass-panel border-t-2 border-t-white/20 shadow-2xl transition-transform duration-300 transform translate-y-0 md:translate-y-0">
        <!-- Title bar -->
        <div class="bg-gradient-to-r from-gray-800 to-gray-900 p-1 flex justify-between items-center cursor-move border-b border-black" id="player-drag-handle">
            <div class="flex gap-1 ml-1">
                <div class="w-2 h-2 rounded-full bg-red-500"></div>
                <div class="w-2 h-2 rounded-full bg-yellow-500"></div>
                <div class="w-2 h-2 rounded-full bg-green-500"></div>
            </div>
            <div class="font-mono text-[9px] uppercase tracking-widest text-gray-400 mr-2">Winamp_v2.9</div>
        </div>

        <!-- Player body -->
        <div class="p-4 bg-void/90">
            <!-- LCD Display -->
            <div class="bg-black border-2 border-gray-700 rounded-sm p-2 mb-3 shadow-[inset_0_0_10px_rgba(0,0,0,1)]">
                <div class="font-mono text-acid text-xs whitespace-nowrap overflow-hidden">
                    <div id="y2k-track-title" class="inline-block">
                         Press play to start
                    </div>
                </div>
                <div class="flex justify-between font-mono text-[10px] text-acid mt-1">
                    <span id="y2k-current-time">0:00</span>
                    <span id="y2k-status-text" class="animate-pulse">Ready</span>
                    <span id="y2k-duration">0:00</span>
                </div>
            </div>

            <!-- Equalizer bars -->
            <div class="flex items-end h-8 gap-[2px] mb-3 opacity-80">
                <div class="w-full bg-acid/20 h-full relative overflow-hidden">
                    <div class="absolute bottom-0 w-[10%] left-[0%] bg-acid h-[40%] animate-pulse"></div>
                    <div class="absolute bottom-0 w-[10%] left-[12%] bg-acid h-[70%] animate-pulse" style="animation-delay: 0.1s"></div>
                    <div class="absolute bottom-0 w-[10%] left-[24%] bg-acid h-[30%] animate-pulse" style="animation-delay: 0.3s"></div>
                    <div class="absolute bottom-0 w-[10%] left-[36%] bg-acid h-[90%] animate-pulse" style="animation-delay: 0.05s"></div>
                    <div class="absolute bottom-0 w-[10%] left-[48%] bg-acid h-[50%] animate-pulse" style="animation-delay: 0.2s"></div>
                    <div class="absolute bottom-0 w-[10%] left-[60%] bg-acid h-[80%] animate-pulse" style="animation-delay: 0.4s"></div>
                    <div class="absolute bottom-0 w-[10%] left-[72%] bg-acid h-[20%] animate-pulse" style="animation-delay: 0.15s"></div>
                    <div class="absolute bottom-0 w-[10%] left-[84%] bg-acid h-[60%] animate-pulse" style="animation-delay: 0.25s"></div>
                </div>
            </div>

            <!-- Progress bar -->
            <div id="y2k-progress" class="w-full h-2 bg-gray-800 rounded cursor-pointer mb-3 relative">
                <div id="y2k-progress-bar" class="h-full bg-acid rounded transition-all" style="width: 0%"></div>
                <div id="y2k-progress-handle" class="absolute top-1/2 -translate-y-1/2 w-2 h-2 bg-white rounded-full" style="left: 0%"></div>
            </div>

            <!-- Controls -->
            <div class="flex justify-between items-center">
                <div class="flex gap-2">
                    <button id="y2k-prev" class="text-gray-400 hover:text-white text-xs">⏮</button>
                    <button id="y2k-play" class="text-acid hover:text-white text-base"><span id="y2k-play-icon">▶</span></button>
                    <button id="y2k-next" class="text-gray-400 hover:text-white text-xs">⏭</button>
                    <button id="y2k-stop" class="text-gray-400 hover:text-white text-xs">⏹</button>
                </div>

                <div class="flex items-center gap-2">
                    <button id="y2k-shuffle" class="text-acid hover:text-acid text-[10px] font-mono transition-colors" title="Shuffle">SHF</button>
                    <button id="y2k-playlist-toggle" class="text-gray-400 hover:text-acid text-[10px] font-mono transition-colors" title="Playlist">LST</button>
                    <div id="y2k-volume" class="w-12 h-1 bg-gray-700 rounded-full cursor-pointer">
                        <div id="y2k-volume-bar" class="w-3/4 h-full bg-acid rounded-full"></div>
                    </div>
                </div>
            </div>

            <!-- Playlist Panel -->
            <div id="y2k-playlist" class="hidden mt-3 border-t border-gray-700 pt-3 max-h-40 overflow-y-auto">
                <div class="font-mono text-[9px] text-gray-500 uppercase tracking-widest mb-2">Playlist</div>
                <div id="y2k-playlist-items" class="space-y-1">
                    <div class="text-gray-500 text-xs font-mono">Loading...</div>
                </div>
            </div>
        </div>

        <!-- Hidden YouTube player -->
        <div id="y2k-yt-container" style="position:absolute;top:0;left:0;width:1px;height:1px;overflow:hidden;opacity:0;pointer-events:none;">
            <div id="y2k-yt-player"></div>
        </div>
    </div>

    <!-- Background Art Info -->
    <div class="fixed bottom-6 right-6 z-50 text-right pointer-events-none mix-blend-difference text-white hidden md:block">
        <div class="font-mono text-[9px] uppercase tracking-widest opacity-70 mb-1">Background Asset</div>
        <div id="art-title" class="font-display font-bold text-lg">36 Points</div>
        <div id="art-artist" class="font-mono text-xs opacity-80">Sage Jenson, 2022</div>
        <div class="mt-2 pointer-events-auto">
             <button class="text-[10px] border border-white/40 px-2 py-1 hover:bg-white hover:text-black transition-colors" onclick="changeArt()">
                [ REFRESH_ASSET ]
             </button>
        </div>
    </div>

    <!-- Scripts -->
    <script>
        // Intro animation
        window.addEventListener('load', () => {
            const loader = document.getElementById('loader');
            const intro = document.getElementById('intro');

            setTimeout(() => {
                loader.classList.remove('w-0');
                loader.classList.add('w-full');
            }, 100);

            setTimeout(() => {
                intro.style.opacity = '0';
                setTimeout(() => {
                    intro.style.display = 'none';
                }, 1000);
            }, 1800);
        });

        // Clock - always PST
        function updateClock() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('en-US', {
                hour12: false,
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                timeZone: 'America/Los_Angeles'
            });
            document.getElementById('clock').textContent = timeString + ' PST';
        }
        setInterval(updateClock, 1000);
        updateClock();

        // Current year
        document.getElementById('current-year').textContent = new Date().getFullYear();

        // Player drag functionality
        const player = document.getElementById('y2k-player');
        let isDragging = false;
        let currentX, currentY, initialX, initialY;
        let xOffset = 0, yOffset = 0;

        document.getElementById('player-drag-handle').addEventListener("mousedown", dragStart);
        document.addEventListener("mouseup", dragEnd);
        document.addEventListener("mousemove", drag);

        function dragStart(e) {
            initialX = e.clientX - xOffset;
            initialY = e.clientY - yOffset;
            isDragging = true;
        }

        function dragEnd(e) {
            initialX = currentX;
            initialY = currentY;
            isDragging = false;
        }

        function drag(e) {
            if (isDragging) {
                e.preventDefault();
                currentX = e.clientX - initialX;
                currentY = e.clientY - initialY;
                xOffset = currentX;
                yOffset = currentY;
                player.style.transform = `translate3d(${currentX}px, ${currentY}px, 0)`;
            }
        }
    </script>

    <!-- Background Art (from config) -->
    <script>
        (function initBackgroundArt() {
            const artworks = window.SITE_CONFIG?.artworks;

            if (!artworks || artworks.length === 0) {
                const config = window.SITE_CONFIG?.backgroundArt;
                if (!config) return;
                applyArtwork(config.src, config.title, config.artist, config.year);
                return;
            }

            const randomIndex = Math.floor(Math.random() * artworks.length);
            const artwork = artworks[randomIndex];
            applyArtwork(artwork.url, artwork.title, artwork.artist, artwork.year);

            window.SITE_CONFIG.backgroundArt = {
                src: artwork.url,
                title: artwork.title,
                artist: artwork.artist,
                year: artwork.year
            };

            function applyArtwork(src, title, artist, year) {
                const artFrame = document.getElementById('art-frame');
                if (artFrame && src) {
                    artFrame.src = src;
                }

                const titleEl = document.getElementById('art-title');
                const artistEl = document.getElementById('art-artist');

                if (titleEl) titleEl.textContent = title || '';
                if (artistEl) artistEl.textContent = `${artist || ''}, ${year || ''}`;
            }
        })();

        function changeArt() {
            const artworks = window.SITE_CONFIG?.artworks;
            if (!artworks || artworks.length === 0) return;

            const frame = document.getElementById('art-frame');
            frame.style.opacity = '0';

            setTimeout(() => {
                const randomIndex = Math.floor(Math.random() * artworks.length);
                const artwork = artworks[randomIndex];
                frame.src = artwork.url;

                document.getElementById('art-title').textContent = artwork.title;
                document.getElementById('art-artist').textContent = `${artwork.artist}, ${artwork.year}`;

                frame.style.opacity = '0.6';
            }, 500);
        }
    </script>

    <!-- Writings Grid -->
    <script>
        (function initWritingsGrid() {
            const grid = document.getElementById('writings-grid');
            if (!grid) return;

            const config = window.SITE_CONFIG?.writings;
            if (!config || config.length === 0) return;

            try {
                localStorage.setItem('conradWritings', JSON.stringify(config));
            } catch (e) {}

            const formatDate = (dateStr) => {
                const date = new Date(dateStr);
                return date.toISOString().split('T')[0];
            };

            const recentItems = config.slice(0, 3);

            grid.innerHTML = recentItems.map((item) => `
                <article class="glass-panel p-6 hover:bg-white/5 transition-all group/card cursor-pointer border-l-2 border-l-transparent hover:border-l-acid">
                    <a href="./writings/index.html#${item.id}" class="block">
                        <div class="flex justify-between items-start mb-4">
                            <span class="font-mono text-xs text-gray-500 border border-gray-800 px-2 py-0.5">TXT</span>
                            <span class="font-mono text-xs text-gray-500">${formatDate(item.date)}</span>
                        </div>
                        <h3 class="font-display text-xl mb-2 group-hover/card:text-acid transition-colors">${item.title}</h3>
                        <p class="font-mono text-xs text-gray-400 leading-relaxed line-clamp-3">${item.description}</p>
                    </a>
                </article>
            `).join('');

            // Add archive link
            grid.innerHTML += `
                <a href="./writings/index.html" class="glass-panel p-6 flex flex-col items-center justify-center gap-2 hover:bg-acid hover:text-black transition-all group/all">
                    <span class="font-mono text-4xl group-hover/all:rotate-90 transition-transform">→</span>
                    <span class="font-mono text-xs uppercase tracking-widest">Archive.zip</span>
                </a>
            `;
        })();
    </script>

    <!-- Collection Grid -->
    <script>
        (function initCollectionGrid() {
            const grid = document.getElementById('collection-grid');
            if (!grid) return;

            const config = window.SITE_CONFIG?.collection;
            if (!config || config.length === 0) return;

            try {
                localStorage.setItem('conradCollection', JSON.stringify(config));
            } catch (e) {}

            // Show 3 most recent items (last 3 in array - newest additions appended to end)
            const recentItems = config.slice(-3).reverse();

            grid.innerHTML = recentItems.map((item) => {
                const actualIndex = config.indexOf(item);
                return `
                <a href="./collection/index.html?index=${actualIndex}" class="aspect-[4/5] relative group cursor-pointer overflow-hidden border border-border-dim hover:border-acid/30 transition-all">
                    <img src="${item.thumbnail}" class="absolute inset-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-110 grayscale group-hover:grayscale-0" alt="${item.title}">
                    <div class="absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent opacity-90"></div>
                    <div class="absolute bottom-0 left-0 w-full p-4 transform translate-y-2 group-hover:translate-y-0 transition-transform">
                        <h4 class="font-display text-lg leading-tight text-white">${item.title}</h4>
                        <p class="font-mono text-[10px] text-gray-400">${item.artist}</p>
                    </div>
                </a>
            `}).join('');
        })();
    </script>

    <!-- GitHub Repos -->
    <script>
        (async function initProjects() {
            const GITHUB_USERNAME = 'nemocake';
            const container = document.getElementById('github-repos');
            if (!container) return;

            container.innerHTML = '<div class="font-mono text-xs text-gray-500">Loading projects...</div>';

            try {
                // Wait for config to load
                const config = await window.waitForConfig(5000);
                const projectsConfig = config?.projects || {};

                // Fetch GitHub repos
                const response = await fetch(`https://api.github.com/users/${GITHUB_USERNAME}/repos?sort=updated&per_page=20`);
                if (!response.ok) throw new Error('Failed to fetch');

                const repos = await response.json();
                const sourceRepos = repos.filter(repo => !repo.fork);

                // Merge GitHub repos with config overrides
                const githubProjects = sourceRepos.map(repo => {
                    const cfg = projectsConfig[repo.name] || {};
                    return {
                        name: repo.name,
                        displayName: cfg.title || repo.name,
                        description: cfg.description || repo.description || 'No description',
                        language: repo.language,
                        stars: repo.stargazers_count,
                        forks: repo.forks_count,
                        url: repo.html_url,
                        isPrivate: false,
                        featured: cfg.featured || false,
                        updated: new Date(repo.updated_at)
                    };
                });

                // Add private/config-only projects
                const privateProjects = Object.entries(projectsConfig)
                    .filter(([key, cfg]) => cfg.private === true)
                    .map(([key, cfg]) => ({
                        name: key,
                        displayName: cfg.title || key,
                        description: cfg.description || '',
                        language: null,
                        stars: null,
                        forks: null,
                        url: null,
                        isPrivate: true,
                        featured: cfg.featured || false,
                        status: cfg.status,
                        tags: cfg.tags || [],
                        updated: new Date()
                    }));

                // Combine and sort: featured first, then by update date
                const allProjects = [...githubProjects, ...privateProjects].sort((a, b) => {
                    if (a.featured && !b.featured) return -1;
                    if (!a.featured && b.featured) return 1;
                    return b.updated - a.updated;
                });

                if (!allProjects.length) {
                    container.innerHTML = '<div class="font-mono text-xs text-gray-500">No projects found.</div>';
                    return;
                }

                container.innerHTML = allProjects.map(project => `
                    <a href="./projects/index.html#${project.name}" class="glass-panel p-5 flex flex-col md:flex-row md:items-center justify-between group hover:border-acid/30 transition-all block">
                        <div class="flex-1">
                            <div class="flex items-center gap-3 mb-2">
                                <h3 class="font-mono font-bold text-lg group-hover:text-acid">${project.displayName}</h3>
                                ${project.featured ? '<span class="text-[10px] font-mono text-acid">★ FEATURED</span>' : ''}
                                ${project.isPrivate ? '<span class="text-[10px] font-mono border border-gray-700 px-1.5 py-0.5 text-gray-500">PRIVATE</span>' : ''}
                                ${project.language ? `<span class="text-[10px] font-mono border border-gray-700 px-1.5 py-0.5 text-gray-400">${project.language}</span>` : ''}
                                ${project.status ? `<span class="text-[10px] font-mono text-neon-blue">${project.status.toUpperCase()}</span>` : ''}
                            </div>
                            <p class="font-sans text-sm text-gray-400 max-w-xl">${project.description}</p>
                        </div>
                        <div class="flex items-center gap-4 mt-4 md:mt-0 font-mono text-xs text-gray-500">
                            ${!project.isPrivate ? `
                                <div class="flex items-center gap-1">★ ${project.stars}</div>
                                <div class="flex items-center gap-1">⑂ ${project.forks}</div>
                            ` : ''}
                            <span class="text-white group-hover:text-acid">::view</span>
                        </div>
                    </a>
                `).join('');
            } catch (error) {
                console.error('[Projects] Error:', error);
                container.innerHTML = '<div class="font-mono text-xs text-gray-500">Could not load projects.</div>';
            }
        })();
    </script>

    <!-- Are.na Inspirations -->
    <script>
        (async function initArenaGrid() {
            const grid = document.getElementById('arena-grid');
            const prevBtn = document.getElementById('arena-prev');
            const nextBtn = document.getElementById('arena-next');
            if (!grid) return;

            const inspirations = window.SITE_CONFIG?.inspirations;
            const channelUrl = inspirations?.channelUrl || 'https://www.are.na/conrad-house/visually-intriguing';
            const channelSlug = inspirations?.channel || 'visually-intriguing';

            let allBlocks = [];
            let currentPage = 0;
            const perPage = 3;

            grid.innerHTML = '<div class="col-span-3 font-mono text-xs text-gray-500">Loading inspirations...</div>';

            function renderBlocks() {
                const start = currentPage * perPage;
                const blocks = allBlocks.slice(start, start + perPage);

                grid.innerHTML = blocks.map(block => {
                    const imageUrl = block.image?.display?.url || block.image?.thumb?.url || '';
                    const blockUrl = `https://www.are.na/block/${block.id}`;
                    const title = block.title || block.generated_title || 'Untitled';
                    return `
                        <a href="${blockUrl}" target="_blank" class="aspect-[4/5] relative group cursor-pointer overflow-hidden border border-border-dim hover:border-acid/30 transition-all">
                            <div class="absolute inset-0 bg-gray-800">
                                ${imageUrl ? `<img src="${imageUrl}" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110 grayscale group-hover:grayscale-0" alt="${title}">` : ''}
                            </div>
                            <div class="absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent opacity-90"></div>
                            <div class="absolute bottom-0 left-0 w-full p-4 transform translate-y-2 group-hover:translate-y-0 transition-transform">
                                <h4 class="font-display text-lg leading-tight text-white line-clamp-2">${title}</h4>
                                <p class="font-mono text-[10px] text-gray-400">are.na</p>
                            </div>
                        </a>
                    `;
                }).join('');

                // Update button states
                const maxPage = Math.ceil(allBlocks.length / perPage) - 1;
                if (prevBtn) prevBtn.disabled = currentPage === 0;
                if (nextBtn) nextBtn.disabled = currentPage >= maxPage;
            }

            try {
                // First get channel info to find total count
                const infoResponse = await fetch(`https://api.are.na/v2/channels/${channelSlug}?per=1`);
                if (!infoResponse.ok) throw new Error('Failed to fetch');
                const info = await infoResponse.json();
                const totalBlocks = info.length || 0;

                // Calculate last page (newest blocks are at the end)
                const perFetch = 30;
                const lastPage = Math.max(1, Math.ceil(totalBlocks / perFetch));

                // Fetch last page to get newest blocks
                const response = await fetch(`https://api.are.na/v2/channels/${channelSlug}?per=${perFetch}&page=${lastPage}`);
                if (!response.ok) throw new Error('Failed to fetch');

                const data = await response.json();
                // Reverse to show newest first (last items in array are newest)
                allBlocks = (data.contents || [])
                    .filter(b => b.image)
                    .reverse();

                renderBlocks();

                // Navigation handlers
                if (prevBtn) {
                    prevBtn.addEventListener('click', () => {
                        if (currentPage > 0) {
                            currentPage--;
                            renderBlocks();
                        }
                    });
                }
                if (nextBtn) {
                    nextBtn.addEventListener('click', () => {
                        const maxPage = Math.ceil(allBlocks.length / perPage) - 1;
                        if (currentPage < maxPage) {
                            currentPage++;
                            renderBlocks();
                        }
                    });
                }
            } catch (error) {
                grid.innerHTML = `
                    <div class="col-span-3 font-mono text-xs text-gray-500">Could not load inspirations. <a href="${channelUrl}" target="_blank" class="text-acid hover:underline">Visit channel →</a></div>
                `;
            }
        })();
    </script>

    <!-- Profile from config -->
    <script>
        (function initProfile() {
            const profile = window.SITE_CONFIG?.profile;
            if (!profile) return;

            if (profile.name) {
                const nameEl = document.getElementById('profile-name');
                if (nameEl) nameEl.textContent = profile.name;
            }

            if (profile.photo) {
                const photoEl = document.getElementById('profile-photo');
                if (photoEl) photoEl.src = profile.photo;
            }

            if (profile.bio && Array.isArray(profile.bio)) {
                const bioEl = document.getElementById('profile-bio');
                if (bioEl) {
                    bioEl.innerHTML = profile.bio.map(line =>
                        `<span class="text-acid">></span> ${line}<br>`
                    ).join('');
                }
            }
        })();
    </script>

    <!-- YouTube IFrame API -->
    <script src="https://www.youtube.com/iframe_api"></script>

    <!-- Y2K Player Controller -->
    <script>
        (function initY2KPlayer() {
            const PLAYLIST_ID = 'PLGl_0guG9m0iKPAfhpooMWA0zKESKkYN4';

            const statusText = document.getElementById('y2k-status-text');
            const trackTitle = document.getElementById('y2k-track-title');
            const currentTimeEl = document.getElementById('y2k-current-time');
            const durationEl = document.getElementById('y2k-duration');
            const progressBar = document.getElementById('y2k-progress-bar');
            const progressHandle = document.getElementById('y2k-progress-handle');
            const progress = document.getElementById('y2k-progress');
            const volumeBar = document.getElementById('y2k-volume-bar');
            const volume = document.getElementById('y2k-volume');
            const playBtn = document.getElementById('y2k-play');
            const playIcon = document.getElementById('y2k-play-icon');
            const stopBtn = document.getElementById('y2k-stop');
            const prevBtn = document.getElementById('y2k-prev');
            const nextBtn = document.getElementById('y2k-next');
            const shuffleBtn = document.getElementById('y2k-shuffle');
            const playlistToggle = document.getElementById('y2k-playlist-toggle');
            const playlistPanel = document.getElementById('y2k-playlist');
            const playlistItems = document.getElementById('y2k-playlist-items');

            let ytPlayer = null;
            let progressInterval = null;
            let isReady = false;
            let isShuffled = true;
            let trackTitles = {};
            let titlesFetched = false;

            function formatTime(seconds) {
                if (!seconds || isNaN(seconds)) return '0:00';
                const mins = Math.floor(seconds / 60);
                const secs = Math.floor(seconds % 60);
                return `${mins}:${secs.toString().padStart(2, '0')}`;
            }

            function updateProgress() {
                if (!ytPlayer || !isReady) return;
                try {
                    const current = ytPlayer.getCurrentTime() || 0;
                    const duration = ytPlayer.getDuration() || 1;
                    const percent = (current / duration) * 100;

                    progressBar.style.width = percent + '%';
                    progressHandle.style.left = percent + '%';
                    currentTimeEl.textContent = formatTime(current);
                    durationEl.textContent = formatTime(duration);
                } catch (e) {}
            }

            function setStatus(state) {
                if (state === 'playing') {
                    statusText.textContent = 'Playing';
                    playIcon.textContent = '⏸';
                } else if (state === 'paused') {
                    statusText.textContent = 'Paused';
                    playIcon.textContent = '▶';
                } else {
                    statusText.textContent = 'Ready';
                    playIcon.textContent = '▶';
                }
            }

            function createPlayer() {
                if (ytPlayer) return;
                ytPlayer = new YT.Player('y2k-yt-player', {
                    height: '200',
                    width: '200',
                    playerVars: {
                        autoplay: 0,
                        controls: 0,
                        disablekb: 1,
                        fs: 0,
                        modestbranding: 1,
                        rel: 0,
                        enablejsapi: 1,
                        listType: 'playlist',
                        list: PLAYLIST_ID
                    },
                    events: {
                        onReady: onPlayerReady,
                        onStateChange: onPlayerStateChange,
                        onError: onPlayerError
                    }
                });
            }

            window.onYouTubeIframeAPIReady = function() {
                createPlayer();
            };

            if (typeof YT !== 'undefined' && YT.Player) {
                createPlayer();
            }

            function onPlayerReady(event) {
                isReady = true;
                setStatus('stopped');
                trackTitle.textContent = 'Press play to start';
                ytPlayer.setVolume(70);
                volumeBar.style.width = '70%';
                try { ytPlayer.setLoop(true); } catch (e) {}
                try { ytPlayer.setShuffle(true); } catch (e) {}
                setTimeout(updateTrackInfo, 1000);
            }

            function onPlayerStateChange(event) {
                clearInterval(progressInterval);

                switch (event.data) {
                    case YT.PlayerState.PLAYING:
                        setStatus('playing');
                        updateTrackInfo();
                        setTimeout(storeCurrentTitle, 500);
                        progressInterval = setInterval(updateProgress, 500);
                        break;
                    case YT.PlayerState.PAUSED:
                        setStatus('paused');
                        updateTrackInfo();
                        break;
                    case YT.PlayerState.ENDED:
                        setStatus('stopped');
                        break;
                    case YT.PlayerState.BUFFERING:
                        statusText.textContent = 'Loading...';
                        setTimeout(updateTrackInfo, 300);
                        break;
                    case YT.PlayerState.CUED:
                        setStatus('stopped');
                        updateTrackInfo();
                        ytPlayer.playVideo();
                        break;
                    default:
                        setStatus('stopped');
                }
            }

            function onPlayerError(event) {
                trackTitle.textContent = 'Skipping...';
                setStatus('stopped');
                setTimeout(() => {
                    if (ytPlayer && isReady) ytPlayer.nextVideo();
                }, 1500);
            }

            function updateTrackInfo() {
                if (!ytPlayer || !isReady) return;
                try {
                    const videoData = ytPlayer.getVideoData();
                    if (videoData && videoData.title) {
                        setTrackTitle(videoData.title);
                    } else {
                        setTrackTitle('Loading...');
                    }
                } catch (e) {
                    setTrackTitle('YouTube Playlist');
                }
            }

            function setTrackTitle(title) {
                const container = trackTitle.parentElement;
                const maxWidth = container ? container.offsetWidth : 200;

                const measureSpan = document.createElement('span');
                measureSpan.style.cssText = 'position:absolute;visibility:hidden;white-space:nowrap;font-size:0.75rem;';
                measureSpan.textContent = title;
                document.body.appendChild(measureSpan);
                const textWidth = measureSpan.offsetWidth;
                document.body.removeChild(measureSpan);

                if (textWidth > maxWidth - 10) {
                    trackTitle.innerHTML = title + '<span style="padding:0 30px;">•</span>' + title;
                    trackTitle.classList.add('scrolling');
                } else {
                    trackTitle.textContent = title;
                    trackTitle.classList.remove('scrolling');
                }
            }

            playBtn?.addEventListener('click', () => {
                if (!ytPlayer || !isReady) {
                    trackTitle.textContent = 'Loading player...';
                    return;
                }
                const state = ytPlayer.getPlayerState();
                if (state === YT.PlayerState.PLAYING) {
                    ytPlayer.pauseVideo();
                } else {
                    statusText.textContent = 'Loading...';
                    ytPlayer.playVideo();
                }
            });

            stopBtn?.addEventListener('click', () => {
                if (!ytPlayer || !isReady) return;
                ytPlayer.stopVideo();
                progressBar.style.width = '0%';
                progressHandle.style.left = '0%';
                currentTimeEl.textContent = '0:00';
                setStatus('stopped');
            });

            prevBtn?.addEventListener('click', () => {
                if (!ytPlayer || !isReady) return;
                trackTitle.textContent = 'Loading...';
                statusText.textContent = 'Loading...';
                try {
                    const playlist = ytPlayer.getPlaylist();
                    const index = ytPlayer.getPlaylistIndex();
                    if (index === 0 && playlist && playlist.length > 0) {
                        ytPlayer.playVideoAt(playlist.length - 1);
                    } else {
                        ytPlayer.previousVideo();
                    }
                } catch (e) {}
            });

            nextBtn?.addEventListener('click', () => {
                if (!ytPlayer || !isReady) return;
                trackTitle.textContent = 'Loading...';
                statusText.textContent = 'Loading...';
                try {
                    const playlist = ytPlayer.getPlaylist();
                    const index = ytPlayer.getPlaylistIndex();
                    if (playlist && index >= playlist.length - 1) {
                        ytPlayer.playVideoAt(0);
                    } else {
                        ytPlayer.nextVideo();
                    }
                } catch (e) {}
            });

            progress?.addEventListener('click', (e) => {
                if (!ytPlayer || !isReady) return;
                const rect = progress.getBoundingClientRect();
                const percent = (e.clientX - rect.left) / rect.width;
                const duration = ytPlayer.getDuration();
                ytPlayer.seekTo(percent * duration, true);
            });

            volume?.addEventListener('click', (e) => {
                if (!ytPlayer || !isReady) return;
                const rect = volume.getBoundingClientRect();
                const percent = Math.max(0, Math.min(1, (e.clientX - rect.left) / rect.width));
                ytPlayer.setVolume(percent * 100);
                volumeBar.style.width = (percent * 100) + '%';
            });

            // Playlist toggle
            playlistToggle?.addEventListener('click', () => {
                playlistPanel.classList.toggle('hidden');
                if (!playlistPanel.classList.contains('hidden')) {
                    renderPlaylist();
                }
            });

            // Shuffle toggle
            shuffleBtn?.addEventListener('click', () => {
                if (!ytPlayer || !isReady) return;
                isShuffled = !isShuffled;
                ytPlayer.setShuffle(isShuffled);
                shuffleBtn.classList.toggle('text-acid', isShuffled);
                shuffleBtn.classList.toggle('text-gray-400', !isShuffled);
            });

            // Fetch all track titles from YouTube oEmbed
            async function fetchAllTitles() {
                if (titlesFetched || !ytPlayer || !isReady) return;
                const playlist = ytPlayer.getPlaylist();
                if (!playlist || playlist.length === 0) return;

                titlesFetched = true;

                // Fetch titles in parallel
                const promises = playlist.map(async (videoId, idx) => {
                    try {
                        const response = await fetch(`https://www.youtube.com/oembed?url=https://www.youtube.com/watch?v=${videoId}&format=json`);
                        if (response.ok) {
                            const data = await response.json();
                            trackTitles[idx] = data.title;
                        }
                    } catch (e) {
                        // Keep default title on error
                    }
                });

                await Promise.all(promises);

                // Re-render playlist with fetched titles
                if (!playlistPanel.classList.contains('hidden')) {
                    renderPlaylist();
                }
            }

            // Render playlist
            function renderPlaylist() {
                if (!ytPlayer || !isReady) return;
                try {
                    const playlist = ytPlayer.getPlaylist();
                    const currentIdx = ytPlayer.getPlaylistIndex();
                    if (!playlist || playlist.length === 0) {
                        playlistItems.innerHTML = '<div class="text-gray-500 text-xs font-mono">No tracks</div>';
                        return;
                    }

                    // Fetch titles if not already done
                    if (!titlesFetched) fetchAllTitles();

                    // Store current track title as fallback
                    const currentTitle = ytPlayer.getVideoData()?.title;
                    if (currentTitle) trackTitles[currentIdx] = currentTitle;

                    playlistItems.innerHTML = playlist.map((videoId, idx) => {
                        const title = trackTitles[idx] || `Loading...`;
                        return `
                        <div class="playlist-item flex items-center gap-2 py-1 px-2 rounded cursor-pointer hover:bg-white/5 transition-colors ${idx === currentIdx ? 'bg-acid/10 text-acid' : 'text-gray-400'}" data-index="${idx}">
                            <span class="text-[10px] font-mono w-4 opacity-50">${String(idx + 1).padStart(2, '0')}</span>
                            <span class="text-xs font-mono truncate flex-1">${title}</span>
                        </div>
                    `}).join('');

                    // Add click handlers
                    playlistItems.querySelectorAll('.playlist-item').forEach(item => {
                        item.addEventListener('click', () => {
                            const idx = parseInt(item.dataset.index, 10);
                            ytPlayer.playVideoAt(idx);
                            setTimeout(() => renderPlaylist(), 500);
                        });
                    });
                } catch (e) {
                    playlistItems.innerHTML = '<div class="text-gray-500 text-xs font-mono">Error loading playlist</div>';
                }
            }

            // Update stored title when track changes
            function storeCurrentTitle() {
                if (!ytPlayer || !isReady) return;
                const idx = ytPlayer.getPlaylistIndex();
                const title = ytPlayer.getVideoData()?.title;
                if (title && idx >= 0) {
                    trackTitles[idx] = title;
                    if (!playlistPanel.classList.contains('hidden')) {
                        renderPlaylist();
                    }
                }
            }
        })();
    </script>

    <!-- Custom Contact Modal -->
    <div id="contact-modal" class="fixed inset-0 z-[9999] hidden items-center justify-center p-4">
        <!-- Backdrop -->
        <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="closeContactModal()"></div>

        <!-- Scanlines overlay for modal -->
        <div class="absolute inset-0 pointer-events-none opacity-40" style="background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0) 50%, rgba(0,0,0,0.15) 50%, rgba(0,0,0,0.15)); background-size: 100% 4px;"></div>

        <!-- Modal Content -->
        <div class="relative w-full max-w-md glass-panel border border-acid/30 shadow-[0_0_40px_rgba(204,255,0,0.15)]">
            <!-- Title Bar (like Winamp) -->
            <div class="bg-gradient-to-r from-gray-900 to-black p-3 flex justify-between items-center border-b border-acid/20">
                <div class="flex items-center gap-3">
                    <div class="flex gap-1.5">
                        <div class="w-3 h-3 rounded-full bg-red-500 cursor-pointer hover:bg-red-400" onclick="closeContactModal()"></div>
                        <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                        <div class="w-3 h-3 rounded-full bg-green-500"></div>
                    </div>
                    <span class="font-mono text-xs text-acid uppercase tracking-widest">Contact_v1.0</span>
                </div>
                <button onclick="closeContactModal()" class="font-mono text-gray-500 hover:text-acid text-lg leading-none">&times;</button>
            </div>

            <!-- Header -->
            <div class="p-6 pb-4 border-b border-white/5">
                <div class="flex items-center gap-3 mb-2">
                    <span class="font-mono text-acid text-xl">:)</span>
                    <h3 class="font-display text-xl font-bold text-white">Get in touch</h3>
                </div>
                <p class="font-mono text-xs text-gray-500">messages go directly to my inbox</p>
            </div>

            <!-- Tally Form Embed -->
            <div class="p-6">
                <iframe
                    data-tally-src="https://tally.so/embed/KY10X8?alignLeft=1&hideTitle=1&transparentBackground=1&dynamicHeight=1"
                    loading="lazy"
                    width="100%"
                    height="300"
                    frameborder="0"
                    marginheight="0"
                    marginwidth="0"
                    title="Contact Form"
                    style="background: transparent;"
                ></iframe>
            </div>

            <!-- Footer -->
            <div class="px-6 py-3 border-t border-white/5 bg-black/30">
                <p class="font-mono text-[10px] text-gray-600 text-center">powered by tally.so • responses are private</p>
            </div>
        </div>
    </div>

    <!-- Contact Modal Script -->
    <script>
        function openContactModal() {
            const modal = document.getElementById('contact-modal');
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            document.body.style.overflow = 'hidden';

            // Load Tally iframe when modal opens
            const iframe = modal.querySelector('iframe[data-tally-src]');
            if (iframe && !iframe.src) {
                iframe.src = iframe.dataset.tallySrc;
            }
        }

        function closeContactModal() {
            const modal = document.getElementById('contact-modal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
            document.body.style.overflow = '';
        }

        // Close on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeContactModal();
        });
    </script>

</body>
</html>
