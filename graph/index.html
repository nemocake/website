<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="3D knowledge graph visualization of Are.na channels and blocks.">
    <title>con.rad | graph</title>

    <script src="https://cdn.tailwindcss.com/3.4.17"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&family=Space+Grotesk:wght@300..700&family=Syne:wght@400;700;800&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'mono': ['"JetBrains Mono"', 'monospace'],
                        'sans': ['"Space Grotesk"', 'sans-serif'],
                        'display': ['"Syne"', 'sans-serif'],
                    },
                    colors: {
                        'acid': '#ccff00',
                        'neon-blue': '#00f3ff',
                        'void': '#050505',
                        'glass': 'rgba(255, 255, 255, 0.05)',
                        'glass-dark': 'rgba(0, 0, 0, 0.6)',
                        'border-dim': 'rgba(255, 255, 255, 0.1)',
                    },
                    animation: {
                        'spin-slow': 'spin 12s linear infinite',
                        'blink': 'blink 1s step-end infinite',
                        'glitch': 'glitch 1s linear infinite',
                        'pulse-glow': 'pulse-glow 2s ease-in-out infinite',
                        'boot-line': 'boot-line 0.6s ease-out forwards',
                    },
                    keyframes: {
                        blink: { '0%, 100%': { opacity: '1' }, '50%': { opacity: '0' } },
                        glitch: {
                            '2%, 64%': { transform: 'translate(2px,0) skew(0deg)' },
                            '4%, 60%': { transform: 'translate(-2px,0) skew(0deg)' },
                            '62%': { transform: 'translate(0,0) skew(5deg)' },
                        },
                        'pulse-glow': {
                            '0%, 100%': { boxShadow: '0 0 5px rgba(204,255,0,0.3)' },
                            '50%': { boxShadow: '0 0 20px rgba(204,255,0,0.6)' },
                        },
                        'boot-line': {
                            '0%': { width: '0%', opacity: '0' },
                            '100%': { width: '100%', opacity: '1' },
                        }
                    }
                }
            }
        }
    </script>

  <script type="module" crossorigin src="/website/graph/assets/index-ByigF4Io.js"></script>
  <link rel="stylesheet" crossorigin href="/website/graph/assets/index-C8oX0uoG.css">
</head>

<body class="bg-void text-gray-200 antialiased overflow-hidden selection:bg-acid selection:text-black">

    <!-- Overlays -->
    <div class="scanlines"></div>
    <div class="noise"></div>

    <!-- Mobile Splash -->
    <div id="mobile-splash" class="fixed inset-0 z-[200] bg-void flex flex-col items-center justify-center p-8 md:hidden">
        <div class="text-center max-w-sm">
            <div class="font-mono text-acid text-xs tracking-widest mb-6 animate-pulse">DEVICE_CHECK_FAILED</div>
            <pre class="text-acid text-4xl mb-6 leading-none">
  ___
 /   \
| x_x |
 \___/
            </pre>
            <h2 class="font-display text-2xl font-bold text-white mb-4">Desktop Required</h2>
            <p class="font-sans text-gray-400 text-sm leading-relaxed mb-6">
                The knowledge graph needs room to breathe. Come back on a larger screen.
            </p>
            <p class="font-mono text-[10px] text-gray-600 uppercase tracking-widest">
                sorry phone users...come back on desktop
            </p>
        </div>
    </div>

    <!-- Boot Loader -->
    <div id="boot-screen" class="fixed inset-0 z-[100] bg-void flex flex-col items-center justify-center transition-opacity duration-700">
        <div class="max-w-md w-full px-8">
            <div class="font-mono text-acid text-xs mb-6 animate-pulse tracking-widest">GRAPH_INIT_SEQUENCE</div>
            <div class="font-display text-4xl font-bold tracking-tighter text-white mb-8">KNOWLEDGE<br>GRAPH</div>
            <div id="boot-log" class="font-mono text-[11px] text-gray-500 space-y-1 mb-8 h-28 overflow-hidden"></div>
            <div class="w-full h-[2px] bg-gray-900 rounded overflow-hidden">
                <div id="boot-progress" class="h-full bg-acid transition-all duration-500 ease-out" style="width: 0%"></div>
            </div>
            <div class="flex justify-between mt-2">
                <span class="font-mono text-[9px] text-gray-600" id="boot-percent">0%</span>
                <span class="font-mono text-[9px] text-gray-600" id="boot-status">initializing...</span>
            </div>
        </div>
    </div>

    <!-- Hover Tooltip -->
    <div id="hover-tooltip" class="fixed z-[60] glass-panel p-2.5 max-w-[200px] opacity-0 hidden" style="will-change: transform;">
        <div id="tooltip-thumb" class="w-full h-[100px] bg-gray-900 border border-white/[0.06] overflow-hidden mb-2 hidden">
            <img id="tooltip-img" class="w-full h-full object-cover" src="" alt="">
        </div>
        <div class="flex items-center gap-1.5 mb-1">
            <span id="tooltip-type" class="font-mono text-[8px] border px-1 py-0.5" style="border-color: rgba(255,255,255,0.15); color: rgba(255,255,255,0.5);"></span>
        </div>
        <div id="tooltip-title" class="font-mono text-[10px] text-white leading-tight truncate"></div>
        <div id="tooltip-text" class="font-sans text-[9px] text-gray-400 mt-1.5 leading-relaxed italic hidden" style="display:-webkit-box; -webkit-line-clamp:3; -webkit-box-orient:vertical; overflow:hidden;"></div>
        <div class="font-mono text-[8px] text-gray-600 mt-1">click to inspect</div>
    </div>

    <!-- Main Layout -->
    <div class="fixed inset-0 flex flex-col hidden md:flex" id="app">

        <!-- Top Bar -->
        <header class="flex items-center justify-between px-5 py-3 border-b border-white/[0.06] bg-void/80 backdrop-blur-md z-40 relative">
            <div class="flex items-center gap-8">
                <a href="../index.html" class="group flex items-center gap-2">
                    <span class="font-display font-bold text-xl tracking-tighter group-hover:text-acid transition-colors">con.rad</span>
                    <span class="font-mono text-[9px] text-gray-600 tracking-widest">/graph</span>
                </a>
                <nav class="flex items-center gap-5 font-mono text-[10px] tracking-wider text-gray-500">
                    <a href="../writings/index.html" class="hover:text-acid transition-colors">WRITINGS</a>
                    <a href="../projects/index.html" class="hover:text-acid transition-colors">PROJECTS</a>
                    <a href="../collection/index.html" class="hover:text-acid transition-colors">COLLECTION</a>
                    <span class="text-acid border-b border-acid pb-px">GRAPH</span>
                </nav>
            </div>

            <div class="absolute left-1/2 -translate-x-1/2 flex items-center gap-5 font-mono text-[10px] text-gray-600">
                <span id="stat-channels">--</span>
                <span class="text-gray-800">|</span>
                <span id="stat-blocks">--</span>
                <span class="text-gray-800">|</span>
                <span id="stat-edges">--</span>
                <span class="text-gray-800">|</span>
                <span id="stat-cross">--</span>
            </div>

            <div class="flex items-center gap-2">
                <div class="relative">
                    <input type="text" id="search-input" placeholder="search..."
                        class="bg-transparent border border-white/10 rounded-none px-3 py-1.5 text-[11px] font-mono
                               text-gray-300 placeholder-gray-600 focus:border-acid/50 focus:outline-none w-44
                               transition-colors">
                    <span class="absolute right-2 top-1/2 -translate-y-1/2 font-mono text-[9px] text-gray-700">/</span>
                </div>
                <button class="ctrl-btn" id="btn-fit" title="Fit to view">FIT</button>
                <button class="ctrl-btn" id="btn-reset" title="Reset view">RST</button>
                <div class="relative" id="shape-wrapper">
                    <button class="ctrl-btn flex items-center gap-1.5" id="shape-trigger">
                        <span id="shape-label">SPIRAL</span>
                        <svg width="8" height="8" viewBox="0 0 8 8" class="opacity-40"><path d="M0 2l4 4 4-4" fill="currentColor"/></svg>
                    </button>
                    <div id="shape-dropdown" class="glass-panel" style="position:absolute; top:calc(100% + 4px); left:0; width:120px; z-index:50; display:none; flex-direction:column;">
                        <button class="shape-option active" data-shape="spiral">SPIRAL</button>
                        <button class="shape-option" data-shape="galaxy">GALAXY</button>
                        <button class="shape-option" data-shape="sphere">SPHERE</button>
                        <button class="shape-option" data-shape="head">HEAD</button>
                    </div>
                </div>
                <span id="head-mesh-toggles" class="inline-flex items-center gap-1 ml-0" style="display: none;">
                    <button class="ctrl-btn active text-[8px] px-1.5 py-0.5" id="btn-toggle-head-mesh" title="Toggle head wireframe" style="font-size:8px; padding: 2px 5px; color: #00ff88;">SKULL</button>
                    <button class="ctrl-btn active text-[8px] px-1.5 py-0.5" id="btn-toggle-brain-mesh" title="Toggle brain wireframe" style="font-size:8px; padding: 2px 5px; color: #ff6688;">BRAIN</button>
                </span>
                <button class="ctrl-btn" id="btn-spin" title="Spin — rotate from current view">SPIN</button>
                <button class="ctrl-btn" id="btn-drift" title="Drift mode — orbit + morph">DRIFT</button>
                <button class="ctrl-btn" id="btn-living" title="Living mode — breathing nodes">LIVING</button>
                <button class="ctrl-btn" id="btn-aurora" title="Aurora mode — color waves">AURORA</button>
                <button class="ctrl-btn" id="btn-dream" title="Dream mode — particle symphony">DREAM</button>
                <span class="w-2 h-2 rounded-full bg-acid animate-pulse shadow-[0_0_10px_#ccff00] ml-1"></span>
            </div>
        </header>

        <!-- Filter Bar -->
        <div class="flex items-center gap-2 px-5 py-2 border-b border-white/[0.04] bg-void/60 backdrop-blur-sm z-30">
            <div class="flex items-center gap-1.5 mr-3">
                <span class="font-mono text-[8px] text-gray-600 uppercase tracking-widest mr-1">Type</span>
                <button class="type-pill active" data-type="Image">IMG <span class="text-gray-600" id="count-Image"></span></button>
                <button class="type-pill active" data-type="Media">MDA <span class="text-gray-600" id="count-Media"></span></button>
                <button class="type-pill active" data-type="Link">LNK <span class="text-gray-600" id="count-Link"></span></button>
                <button class="type-pill active" data-type="Text">TXT <span class="text-gray-600" id="count-Text"></span></button>
                <button class="type-pill active" data-type="Attachment">ATT <span class="text-gray-600" id="count-Attachment"></span></button>
            </div>

            <span class="text-gray-800">|</span>

            <button class="ctrl-btn" id="btn-crosslinks" title="Highlight cross-linked blocks">XLINKS</button>
            <button class="ctrl-btn" id="btn-random" title="Jump to random block">RANDOM</button>
            <button class="ctrl-btn" id="btn-walk" title="Random walk mode">WALK</button>
            <button class="ctrl-btn" id="btn-gallery" title="Gallery view">GALLERY</button>
            <button class="ctrl-btn" id="btn-path" title="Find path between blocks">PATH</button>
            <button class="ctrl-btn" id="btn-constellation" title="Show tag connections">CONSTELLATE</button>
            <button class="ctrl-btn" id="btn-age" title="Age heatmap">AGE</button>
            <button class="ctrl-btn" id="btn-stats" title="Collection statistics">STATS</button>

            <span class="text-gray-800">|</span>

            <button class="ctrl-btn active" id="btn-toggle-minimap" title="Toggle minimap">MAP</button>
            <button class="ctrl-btn active" id="btn-toggle-timeline" title="Toggle timeline">TIME</button>
            <button class="ctrl-btn active" id="btn-toggle-legend" title="Toggle channel legend">LEGEND</button>

            <span class="text-gray-800 ml-auto">|</span>

            <!-- Channel Filter -->
            <div class="relative" id="ch-filter-wrapper">
                <button class="ctrl-btn flex items-center gap-1.5" id="ch-filter-trigger">
                    <span id="ch-filter-label">CHANNELS</span>
                    <svg width="8" height="8" viewBox="0 0 8 8" class="opacity-40"><path d="M0 2l4 4 4-4" fill="currentColor"/></svg>
                </button>
                <div id="ch-filter-dropdown" class="glass-panel" style="position:absolute; top:calc(100% + 4px); right:0; width:260px; max-height:400px; z-index:50; display:none; flex-direction:column;">
                    <div class="flex items-center justify-between p-2 border-b border-white/[0.06]">
                        <span class="font-mono text-[9px] text-gray-500 uppercase tracking-widest">Toggle Channels</span>
                        <div class="flex gap-2">
                            <button class="font-mono text-[8px] text-gray-500 hover:text-acid" id="ch-filter-all">ALL</button>
                            <button class="font-mono text-[8px] text-gray-500 hover:text-acid" id="ch-filter-none">NONE</button>
                        </div>
                    </div>
                    <div id="ch-filter-list" class="overflow-y-auto p-1" style="max-height:340px;"></div>
                </div>
            </div>

            <!-- Category Filter -->
            <div class="relative" id="cat-filter-wrapper">
                <div class="flex items-center gap-1.5">
                    <button class="ctrl-btn flex items-center gap-1.5" id="cat-filter-trigger">
                        <span id="cat-filter-label">FILTER</span>
                        <svg width="8" height="8" viewBox="0 0 8 8" class="opacity-40"><path d="M0 2l4 4 4-4" fill="currentColor"/></svg>
                    </button>
                    <div id="cat-filter-active-pills" class="flex items-center gap-1 overflow-x-auto" style="max-width: 300px;"></div>
                </div>
                <div id="cat-filter-dropdown" class="glass-panel" style="position:absolute; top:calc(100% + 4px); right:0; width:300px; max-height:420px; z-index:50; display:none; flex-direction:column;">
                    <div class="flex gap-1 p-2 border-b border-white/[0.06]">
                        <button class="cat-tab active" data-cat="artist" style="--cat-color:#ff3366;">ART <span class="opacity-40" id="cat-count-artist"></span></button>
                        <button class="cat-tab" data-cat="medium" style="--cat-color:#00ff88;">MED <span class="opacity-40" id="cat-count-medium"></span></button>
                        <button class="cat-tab" data-cat="theme" style="--cat-color:#00f3ff;">THM <span class="opacity-40" id="cat-count-theme"></span></button>
                        <button class="cat-tab" data-cat="source" style="--cat-color:#ff9900;">SRC <span class="opacity-40" id="cat-count-source"></span></button>
                    </div>
                    <div class="p-2 border-b border-white/[0.06]">
                        <input type="text" class="cat-filter-search" id="cat-filter-search" placeholder="search..." autocomplete="off" spellcheck="false">
                    </div>
                    <div id="cat-filter-list" class="overflow-y-auto" style="max-height: 300px;"></div>
                </div>
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="flex-1 relative overflow-hidden">
            <!-- Three.js Canvas Mount -->
            <div id="graph-container" class="absolute inset-0 graph-bg" style="cursor: crosshair;"></div>

            <!-- Loading Indicator -->
            <div id="graph-loading-indicator" class="absolute top-4 left-1/2 -translate-x-1/2 font-mono text-[10px] text-acid tracking-widest z-20 hidden">
                COMPUTING...
            </div>

            <!-- Zoom Slider -->
            <div id="zoom-slider-wrapper" class="absolute left-4 z-20 flex flex-col items-center gap-1" style="top: 50%; transform: translateY(-50%);">
                <span class="font-mono text-[8px] text-gray-600 select-none">+</span>
                <input type="range" id="zoom-slider" min="0" max="1000" value="500" orient="vertical"
                    class="zoom-slider-vertical" />
                <span class="font-mono text-[8px] text-gray-600 select-none">−</span>
            </div>

            <!-- Channel Legend -->
            <div id="channel-legend" class="absolute bottom-4 left-4 glass-panel p-3 z-20 opacity-0 transition-opacity duration-500" style="max-width: 200px;">
                <div class="font-mono text-[8px] text-gray-600 uppercase tracking-widest mb-2">Channels</div>
                <div id="legend-items" class="space-y-1.5"></div>
                <div class="mt-3 pt-2 border-t border-white/[0.06]">
                    <div class="font-mono text-[8px] text-gray-600">
                        synced: <span id="sync-date" class="text-gray-500">--</span>
                    </div>
                </div>
            </div>

            <!-- Minimap -->
            <canvas id="minimap-canvas" class="absolute bottom-4 right-4 z-20 border border-white/[0.06]" width="180" height="130" style="image-rendering: pixelated; background: rgba(0,0,0,0.4);"></canvas>

            <!-- Timeline Scrubber -->
            <div class="absolute bottom-4 left-1/2 -translate-x-1/2 z-20 glass-panel px-4 py-2 hidden" id="timeline-panel" style="width: 400px;">
                <div class="flex items-center justify-between mb-1">
                    <span class="font-mono text-[8px] text-gray-600 uppercase tracking-widest">Timeline</span>
                    <div class="flex items-center gap-3 font-mono text-[9px]">
                        <span id="timeline-start-label" class="text-gray-500">--</span>
                        <span class="text-gray-700">→</span>
                        <span id="timeline-end-label" class="text-gray-500">--</span>
                    </div>
                </div>
                <div class="timeline-track">
                    <input type="range" id="timeline-scrubber" min="0" max="1000" value="0">
                    <input type="range" id="timeline-end" min="0" max="1000" value="1000">
                </div>
                <div class="flex justify-between mt-1">
                    <span id="timeline-min-date" class="font-mono text-[8px] text-gray-700">--</span>
                    <span id="timeline-count" class="font-mono text-[8px] text-acid">--</span>
                    <span id="timeline-max-date" class="font-mono text-[8px] text-gray-700">--</span>
                </div>
            </div>

            <!-- Detail Panel (right slide-out) -->
            <div id="detail-panel" class="detail-panel absolute top-0 right-0 h-full w-[380px] glass-panel z-30 overflow-y-auto">
                <div class="p-5">
                    <div class="flex items-center justify-between mb-4">
                        <span class="font-mono text-[8px] text-gray-600 uppercase tracking-widest">Block Inspector</span>
                        <button id="detail-close" class="font-mono text-[10px] text-gray-500 hover:text-acid transition-colors">[×]</button>
                    </div>
                    <div id="detail-content"></div>
                </div>
            </div>

            <!-- Gallery Panel (bottom slide-up) -->
            <div id="gallery-panel" class="gallery-panel absolute bottom-0 left-0 right-0 h-[45%] glass-panel z-25 overflow-hidden flex flex-col">
                <div class="flex items-center justify-between px-4 py-2 border-b border-white/[0.06]">
                    <div class="flex items-center gap-3">
                        <span class="font-mono text-[8px] text-gray-600 uppercase tracking-widest">Gallery</span>
                        <span id="gallery-count" class="font-mono text-[9px] text-gray-500">0 blocks</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <select id="gallery-sort" class="bg-transparent border border-white/10 font-mono text-[9px] text-gray-400 px-2 py-1 outline-none">
                            <option value="newest">Newest</option>
                            <option value="oldest">Oldest</option>
                            <option value="alpha">A-Z</option>
                            <option value="connections">Connections</option>
                        </select>
                        <button id="gallery-close" class="font-mono text-[10px] text-gray-500 hover:text-acid">[×]</button>
                    </div>
                </div>
                <div id="gallery-grid" class="gallery-grid p-3 overflow-y-auto flex-1"></div>
            </div>

            <!-- Stats Modal -->
            <div id="stats-modal" class="fixed inset-0 z-[80] flex items-center justify-center hidden" style="background: rgba(0,0,0,0.7);">
                <div class="glass-panel p-6 w-[600px] max-h-[80vh] overflow-y-auto">
                    <div class="flex items-center justify-between mb-4">
                        <span class="font-mono text-[8px] text-gray-600 uppercase tracking-widest">Collection Statistics</span>
                        <button id="stats-close" class="font-mono text-[10px] text-gray-500 hover:text-acid">[×]</button>
                    </div>
                    <div id="stats-content"></div>
                </div>
            </div>

            <!-- Path Finder Status -->
            <div id="path-status" class="absolute top-4 left-4 z-20 glass-panel px-3 py-2 hidden">
                <div class="font-mono text-[9px] text-gray-400" id="path-status-text">Click first node...</div>
            </div>

            <!-- Walk Breadcrumbs -->
            <div id="walk-breadcrumbs" class="absolute top-4 left-4 z-20 glass-panel px-3 py-2 hidden">
                <div class="flex items-center gap-1 flex-wrap" id="walk-trail"></div>
            </div>

            <!-- Age Heatmap Legend -->
            <div id="age-legend" class="absolute top-4 right-4 z-20 glass-panel px-3 py-2 hidden" style="width: 200px;">
                <div class="font-mono text-[8px] text-gray-600 uppercase tracking-widest mb-2">Age Heatmap</div>
                <div class="age-gradient mb-1"></div>
                <div class="flex justify-between font-mono text-[8px] text-gray-600">
                    <span id="age-old">oldest</span>
                    <span id="age-new">newest</span>
                </div>
            </div>
        </div>
    </div>

</body>
</html>
