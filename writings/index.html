<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Writings | con.rad">
  <title>Writings | con.rad</title>

  <!-- Config Loader -->
  <script src="../assets/js/config-loader.js"></script>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            'mono': ['"JetBrains Mono"', 'monospace'],
            'sans': ['"Space Grotesk"', 'sans-serif'],
            'display': ['"Syne"', 'sans-serif'],
          },
          colors: {
            'acid': '#ccff00',
            'neon-blue': '#00f3ff',
            'void': '#050505',
            'glass': 'rgba(255, 255, 255, 0.05)',
            'glass-dark': 'rgba(0, 0, 0, 0.6)',
            'border-dim': 'rgba(255, 255, 255, 0.1)',
          },
          animation: {
            'pulse-glow': 'pulse-glow 2s ease-in-out infinite',
          },
          keyframes: {
            'pulse-glow': {
              '0%, 100%': { opacity: '1' },
              '50%': { opacity: '0.5' },
            }
          }
        }
      }
    }
  </script>

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&family=Syne:wght@400;700;800&display=swap" rel="stylesheet">

  <style>
    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 6px;
    }
    ::-webkit-scrollbar-track {
      background: #050505;
    }
    ::-webkit-scrollbar-thumb {
      background: #333;
      border-radius: 3px;
    }
    ::-webkit-scrollbar-thumb:hover {
      background: #ccff00;
    }

    /* Scanlines overlay */
    .scanlines {
      background: linear-gradient(
        to bottom,
        rgba(255,255,255,0),
        rgba(255,255,255,0) 50%,
        rgba(0,0,0,0.1) 50%,
        rgba(0,0,0,0.1)
      );
      background-size: 100% 4px;
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      pointer-events: none;
      z-index: 9999;
      opacity: 0.6;
    }

    /* Noise overlay */
    .noise {
      position: fixed;
      top: 0; left: 0; width: 100vw; height: 100vh;
      pointer-events: none;
      z-index: 9998;
      opacity: 0.03;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
    }

    /* Selection */
    ::selection {
      background: #ccff00;
      color: #000;
    }

    /* Glass panel */
    .glass-panel {
      background: rgba(10, 10, 10, 0.6);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      border: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
    }

    /* Article reveal animation */
    .writing-section {
      opacity: 0;
      transform: translateY(30px);
      transition: opacity 0.6s ease, transform 0.6s ease;
    }
    .writing-section.is-visible {
      opacity: 1;
      transform: translateY(0);
    }

    /* Intro reveal */
    .writings-intro {
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.5s ease, transform 0.5s ease;
    }
    .writings-intro.is-visible {
      opacity: 1;
      transform: translateY(0);
    }

    /* Nav link active state */
    .nav-link-item.is-active {
      color: #ccff00;
      border-left-color: #ccff00;
    }
  </style>
</head>
<body class="bg-void text-gray-200 antialiased overflow-x-hidden selection:bg-acid selection:text-black">
  <!-- Password protection removed -->

  <!-- Overlays -->
  <div class="scanlines"></div>
  <div class="noise"></div>

  <!-- Header -->
  <header class="fixed top-0 left-0 right-0 z-50 px-6 py-4 flex justify-between items-start pointer-events-none mix-blend-difference text-white">
    <a href="../index.html" class="pointer-events-auto group cursor-pointer flex flex-col">
      <span class="font-display font-bold text-2xl tracking-tighter leading-none group-hover:text-acid transition-colors">con.rad</span>
      <span class="font-mono text-[10px] opacity-70 tracking-widest mt-1">BUILDING CURIOSITY...</span>
    </a>

    <nav class="pointer-events-auto hidden md:flex items-center gap-8 font-mono text-xs tracking-wider">
      <a href="../writings/index.html" class="hover:text-acid hover:underline underline-offset-4 decoration-acid decoration-1">[ WRITINGS ]</a>
      <a href="../collection/index.html" class="hover:text-acid hover:underline underline-offset-4 decoration-acid decoration-1">[ COLLECTION ]</a>
      <a href="../index.html#projects" class="hover:text-acid hover:underline underline-offset-4 decoration-acid decoration-1">[ PROJECTS ]</a>
      <a href="../index.html#inspirations" class="hover:text-acid hover:underline underline-offset-4 decoration-acid decoration-1">[ ARE.NA ]</a>
      <span class="w-2 h-2 rounded-full bg-acid animate-pulse-glow shadow-[0_0_10px_#ccff00]"></span>
    </nav>

    <button class="md:hidden pointer-events-auto text-acid">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="square" stroke-linejoin="miter" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
      </svg>
    </button>
  </header>

  <!-- Main Layout -->
  <main class="relative z-10 pt-32 pb-48 px-4 md:px-0 max-w-7xl mx-auto flex flex-col md:flex-row gap-8">

    <!-- Sidebar Navigation -->
    <aside class="md:w-1/4 md:sticky md:top-32 h-fit">
      <div class="glass-panel p-6 rounded-sm">
        <div class="flex items-center gap-3 mb-6">
          <span class="font-mono text-acid text-sm">01.</span>
          <h2 class="font-display text-xl font-bold uppercase">Writings</h2>
        </div>

        <div class="border-t border-dashed border-gray-700 my-4"></div>

        <nav>
          <ul id="writings-nav-list" class="space-y-1">
            <!-- Populated by JS -->
          </ul>
        </nav>

        <div class="border-t border-dashed border-gray-700 my-4"></div>

        <div class="font-mono text-[10px] uppercase tracking-wider text-gray-500 space-y-2">
          <div class="flex justify-between">
            <span>Articles</span>
            <span id="article-count" class="text-acid">0</span>
          </div>
          <div class="flex justify-between">
            <span>Last Updated</span>
            <span id="last-updated">--</span>
          </div>
        </div>
      </div>

      <!-- Back to home -->
      <a href="../index.html" class="glass-panel p-4 mt-4 flex items-center justify-center gap-2 hover:bg-acid hover:text-black transition-all group rounded-sm">
        <span class="font-mono text-xl group-hover:-translate-x-1 transition-transform">←</span>
        <span class="font-mono text-xs uppercase tracking-widest">Back Home</span>
      </a>
    </aside>

    <!-- Content Area -->
    <div class="md:w-3/4 space-y-16">

      <!-- Intro Section -->
      <div class="writings-intro glass-panel p-8 rounded-sm" id="writings-intro">
        <div class="flex items-center gap-4 mb-6">
          <div class="h-[1px] w-12 bg-acid"></div>
          <span class="font-mono text-acid text-xs uppercase tracking-widest">Archive</span>
        </div>
        <h1 class="font-display text-4xl md:text-5xl font-bold mb-4">Writings</h1>
        <p class="font-sans text-lg text-gray-400 max-w-xl leading-relaxed">
          Thoughts on art, technology, and the spaces between. Essays and reflections on what I'm learning and building.
        </p>
      </div>

      <!-- Articles Container -->
      <div id="writings-articles" class="space-y-12">
        <!-- Populated by JS -->
      </div>

    </div>
  </main>

  <!-- Footer -->
  <footer class="relative z-10 border-t border-white/10 bg-black/80 backdrop-blur-md mt-12 py-12">
    <div class="max-w-7xl mx-auto px-6 flex flex-col md:flex-row justify-between items-end gap-6">
      <div>
        <h3 class="font-display text-2xl mb-2">con.rad</h3>
        <p class="font-mono text-xs text-gray-500">© <span id="current-year"></span> Conrad House. Built for the web.</p>
      </div>
      <div class="flex gap-6 font-mono text-xs">
        <a href="mailto:hello@conrad.house" class="hover:text-acid hover:underline">EMAIL</a>
        <a href="#" class="hover:text-acid hover:underline">GITHUB</a>
        <a href="#" class="hover:text-acid hover:underline">TWITTER</a>
      </div>
    </div>
  </footer>

  <!-- JavaScript -->
  <script>
    // Current year
    document.getElementById('current-year').textContent = new Date().getFullYear();

    (function() {
      // Function to render writings
      function renderWritings(writings) {
        if (!writings || writings.length === 0) return;

        // Update article count
        document.getElementById('article-count').textContent = writings.length;

        // Update last updated date - find most recent and parse as local time
        const dates = writings.map(w => {
          const [year, month, day] = w.date.split('-').map(Number);
          return new Date(year, month - 1, day);
        });
        const latestDate = new Date(Math.max(...dates));
        document.getElementById('last-updated').textContent = latestDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' });

        // Format date helper (Month Day, Year) - parse as local to avoid timezone shift
        const formatDate = (dateStr) => {
          const [year, month, day] = dateStr.split('-').map(Number);
          const date = new Date(year, month - 1, day);
          return date.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });
        };

        // Render navigation
        const navList = document.getElementById('writings-nav-list');
        navList.innerHTML = writings.map((item, index) => `
          <li>
            <a href="#${item.id}" class="nav-link-item block font-mono text-xs text-gray-400 hover:text-acid py-2 px-3 border-l-2 border-transparent hover:border-acid/50 transition-all ${index === 0 ? 'is-active' : ''}">
              <span class="text-gray-600 mr-2">${String(index + 1).padStart(2, '0')}</span>
              ${item.title}
            </a>
          </li>
        `).join('');

        // Render articles
        const articlesContainer = document.getElementById('writings-articles');
        articlesContainer.innerHTML = writings.map((item, index) => {
          // Support mixed content: strings become paragraphs, objects render by type
          const bodyHtml = item.body.map(p => {
            if (typeof p === 'string') {
              return `<p class="mb-6 last:mb-0">${p}</p>`;
            } else if (p.type === 'quote') {
              return `<blockquote class="my-8 pl-6 border-l-2 border-acid/50 italic text-gray-400">"${p.text}"</blockquote>`;
            }
            return '';
          }).join('');
          // Legacy quote field (renders at end if present)
          const quoteHtml = item.quote ? `
            <blockquote class="my-8 pl-6 border-l-2 border-acid/50 italic text-gray-400">
              "${item.quote}"
            </blockquote>
          ` : '';

          return `
            <article class="writing-section glass-panel p-8 rounded-sm hover:border-acid/30 transition-all" id="${item.id}">
              <div class="flex items-center gap-4 mb-4">
                <span class="font-mono text-acid text-sm">${String(index + 1).padStart(2, '0')}.</span>
                <span class="font-mono text-xs text-gray-500 border border-gray-700 px-2 py-0.5">TXT</span>
                <span class="font-mono text-xs text-gray-500">${formatDate(item.date)}</span>
              </div>
              <h2 class="font-display text-2xl md:text-3xl font-bold mb-2 group-hover:text-acid">${item.title}</h2>
              <p class="font-mono text-sm text-gray-500 mb-6">${item.description}</p>
              <div class="font-sans text-gray-300 leading-relaxed">
                ${bodyHtml}
                ${quoteHtml}
              </div>
            </article>
          `;
        }).join('');

        // Initialize scroll effects after content is rendered
        initScrollEffects();

        // Handle hash navigation (from homepage links)
        if (window.location.hash) {
          setTimeout(() => {
            const targetId = window.location.hash.substring(1);
            const target = document.getElementById(targetId);
            if (target) {
              const headerOffset = 120;
              const elementPosition = target.getBoundingClientRect().top;
              const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
              window.scrollTo({ top: offsetPosition, behavior: 'smooth' });
            }
          }, 200);
        }
      }

      // Load writings from config.json - no fallbacks, no localStorage nonsense
      function loadWritings() {
        // If config already loaded, use it
        if (window.SITE_CONFIG && window.SITE_CONFIG.writings && window.SITE_CONFIG.writings.length > 0) {
          console.log('[Writings] Loaded from SITE_CONFIG:', window.SITE_CONFIG.writings.length, 'articles');
          renderWritings(window.SITE_CONFIG.writings);
          return;
        }

        // Otherwise wait for config to load
        console.log('[Writings] Waiting for config...');
        window.addEventListener('configLoaded', (e) => {
          const config = e.detail;
          if (config && config.writings && config.writings.length > 0) {
            console.log('[Writings] Config loaded:', config.writings.length, 'articles');
            renderWritings(config.writings);
          } else {
            console.error('[Writings] Config loaded but no writings found');
            document.getElementById('writings-articles').innerHTML = '<p class="text-gray-500 font-mono">Failed to load writings from config.json</p>';
          }
        });

        // Timeout - if config doesn't load in 5 seconds, show error
        setTimeout(() => {
          if (!window.SITE_CONFIG || !window.SITE_CONFIG.writings) {
            console.error('[Writings] Config failed to load');
            document.getElementById('writings-articles').innerHTML = '<p class="text-gray-500 font-mono">Failed to load writings from config.json</p>';
          }
        }, 5000);
      }

      loadWritings();

      function initScrollEffects() {
        const navLinks = document.querySelectorAll('.nav-link-item');
        const sections = document.querySelectorAll('.writing-section');
        const intro = document.querySelector('.writings-intro');

        // Reveal on scroll using Intersection Observer
        const revealObserver = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.classList.add('is-visible');
            }
          });
        }, {
          threshold: 0.1,
          rootMargin: '0px 0px -10% 0px'
        });

        // Observe intro and sections
        if (intro) revealObserver.observe(intro);
        sections.forEach(section => revealObserver.observe(section));

        // Scroll spy - highlight active nav item
        const spyObserver = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              const id = entry.target.getAttribute('id');

              // Update nav links
              navLinks.forEach(link => {
                link.classList.remove('is-active');
                if (link.getAttribute('href') === `#${id}`) {
                  link.classList.add('is-active');
                }
              });
            }
          });
        }, {
          threshold: 0,
          rootMargin: '-20% 0px -60% 0px'
        });

        // Observe sections for scroll spy
        sections.forEach(section => spyObserver.observe(section));

        // Smooth scroll on nav click
        navLinks.forEach(link => {
          link.addEventListener('click', (e) => {
            e.preventDefault();
            const targetId = link.getAttribute('href').substring(1);
            const target = document.getElementById(targetId);

            if (target) {
              const headerOffset = 120;
              const elementPosition = target.getBoundingClientRect().top;
              const offsetPosition = elementPosition + window.pageYOffset - headerOffset;

              window.scrollTo({
                top: offsetPosition,
                behavior: 'smooth'
              });

              // Update URL hash without scrolling
              history.pushState(null, null, `#${targetId}`);
            }
          });
        });

        // Trigger initial reveal for elements in view
        setTimeout(() => {
          if (intro) {
            const introRect = intro.getBoundingClientRect();
            if (introRect.top < window.innerHeight) {
              intro.classList.add('is-visible');
            }
          }

          sections.forEach(section => {
            const rect = section.getBoundingClientRect();
            if (rect.top < window.innerHeight) {
              section.classList.add('is-visible');
            }
          });
        }, 100);
      }
    })();
  </script>

</body>
</html>
